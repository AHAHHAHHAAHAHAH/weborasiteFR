---
import type { SiteConfig } from "../lib/siteConfig";
const { cfg } = Astro.props as { cfg: SiteConfig };
const wa = `https://wa.me/${cfg.contacts.phoneE164}`;

const cta = cfg.navigation.cta;
// Forziamo il link in modo assoluto. Niente cancelletti o percorsi ambigui.
const ctaHref = cta.type === "whatsapp" ? wa : `/contatti`;
---

<header style="position:fixed; top:24px; left:24px; right:24px; z-index:50; display:flex; justify-content:space-between; align-items:flex-start; pointer-events:none;">
  
  <a href="/" style="pointer-events:auto; display:flex; align-items:center; gap:12px; mix-blend-mode: difference; transition: opacity 0.3s ease;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'">
    <img src={cfg.brand.logoPath} alt={cfg.brand.name} style="height:32px; width:auto; display:block; filter: brightness(0) invert(1);" />
    <strong style="font-size:1.1rem; letter-spacing:0.04em; color: #fff;">{cfg.brand.name}</strong>
  </a>

  <div style="display:flex; align-items:center; gap:16px; pointer-events:auto;">
    <a class="btn" style="padding: 10px 24px; font-size: 0.9rem; background: rgba(0,0,0,0.4); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1);" href={ctaHref} target={cta.type === "whatsapp" ? "_blank" : undefined}>{cta.label}</a>
    
    <button class="btn" id="openDrawer" aria-label="Menu" style="padding: 14px; border-radius: 50%; width: 48px; height: 48px; background: rgba(0,0,0,0.4); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1);">
      <span style="display:flex; flex-direction:column; gap:4px; width:20px; align-items:center;">
        <span style="display:block; width:100%; height:2px; background:#fff; border-radius:2px;"></span>
        <span style="display:block; width:100%; height:2px; background:#fff; border-radius:2px;"></span>
      </span>
    </button>
  </div>

  <script>
    document.getElementById("openDrawer")?.addEventListener("click", () => {
      window.dispatchEvent(new CustomEvent("webora:drawer:open"));
    });
  </script>
</header>